2025-06-01 07:01:19,239 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:01:19,240 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///./stock_prediction.db
2025-06-01 07:01:19,240 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:01:19,286 - __main__ - INFO - Menggunakan SQLite: sqlite:///./stock_prediction.db
2025-06-01 07:01:19,317 - __main__ - WARNING - File database SQLite tidak ditemukan: ../stock_prediction.db
2025-06-01 07:01:19,318 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:01:19,318 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:01:19,357 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:01:19,357 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:01:23,008 - __main__ - WARNING - Percobaan 1/3 gagal untuk BBCA.JK: cannot assemble with duplicate keys
2025-06-01 07:01:28,009 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:01:28,069 - __main__ - WARNING - Percobaan 2/3 gagal untuk BBCA.JK: cannot assemble with duplicate keys
2025-06-01 07:01:33,070 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:01:33,263 - __main__ - WARNING - Percobaan 3/3 gagal untuk BBCA.JK: cannot assemble with duplicate keys
2025-06-01 07:01:33,264 - __main__ - ERROR - Gagal mengambil data BBCA.JK setelah 3 percobaan
2025-06-01 07:01:33,296 - __main__ - ERROR - Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 268, in fetch_stock_data
    df['date'] = pd.to_datetime(df['date'])
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\tools\datetimes.py", line 1070, in to_datetime
    result = _assemble_from_unit_mappings(arg, errors, utc)
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\tools\datetimes.py", line 1165, in _assemble_from_unit_mappings
    raise ValueError("cannot assemble with duplicate keys")
ValueError: cannot assemble with duplicate keys

2025-06-01 07:01:33,297 - __main__ - WARNING - Tidak ada data untuk disimpan untuk BBCA.JK interval 1d
2025-06-01 07:01:34,299 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:02:50,682 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:02:50,683 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:02:50,684 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:02:50,731 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:02:50,731 - __main__ - WARNING - File database SQLite tidak ditemukan: .D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:02:50,732 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:02:50,733 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:02:50,765 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:02:50,765 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:02:51,515 - __main__ - ERROR - Error saat menghitung indikator: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:02:51,706 - __main__ - ERROR - Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 218, in calculate_indicators
    macd = ta.macd(df['close'])
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas_ta\momentum\macd.py", line 34, in macd
    histogram = macd - signalma
                ~~~~~^~~~~~~~~~
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\arraylike.py", line 194, in __sub__
    return self._arith_method(other, operator.sub)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\series.py", line 6135, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\base.py", line 1382, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\computation\expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\pandas\core\computation\expressions.py", line 73, in _evaluate_standard
    return op(a, b)
TypeError: unsupported operand type(s) for -: 'float' and 'NoneType'

2025-06-01 07:02:51,706 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:02:55,836 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: type object 'StockPrice' has no attribute 'interval'
2025-06-01 07:02:55,838 - __main__ - ERROR - Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 329, in save_to_database
    StockPrice.interval == interval
    ^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'StockPrice' has no attribute 'interval'

2025-06-01 07:02:55,838 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:02:56,840 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:05:44,689 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:05:44,689 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:05:44,690 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:05:44,733 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:05:44,735 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:05:44,735 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:05:44,769 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:05:44,769 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:05:45,442 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:05:45,456 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:05:45,463 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:05:45,464 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:05:49,625 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ? AND stock_prices.interval = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', '1d', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-01 07:05:49,875 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such column: stock_prices.interval

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 367, in save_to_database
    ).first()
      ~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ? AND stock_prices.interval = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', '1d', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-06-01 07:05:49,875 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:05:50,877 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:12:26,941 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:12:26,942 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:12:26,942 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:12:26,987 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:12:26,988 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:12:26,988 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:12:27,022 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:12:27,022 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:12:27,869 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:12:27,881 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:12:27,891 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:12:27,891 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:12:32,028 - __main__ - WARNING - Database lama terdeteksi, kolom interval tidak ditemukan
2025-06-01 07:12:32,030 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-01 07:12:32,053 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such column: stock_prices.interval

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 368, in save_to_database
    ).first()
      ~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ? AND stock_prices.interval = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', '1d', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such column: stock_prices.interval

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 376, in save_to_database
    ).first()
      ~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-06-01 07:12:32,054 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:12:33,055 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:18:27,375 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:18:27,376 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:18:27,376 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:18:27,389 - __main__ - INFO - Menggunakan DATABASE_URL dari environment: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:18:27,389 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:18:27,424 - __main__ - INFO - Skema database: tabel stock_prices tidak memiliki kolom interval
2025-06-01 07:18:27,424 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:18:27,425 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:18:27,458 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:18:27,458 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:18:28,361 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:18:28,372 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:18:28,380 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:18:28,380 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:18:32,513 - __main__ - INFO - Status skema DB: has_interval_column=False
2025-06-01 07:18:32,519 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-01 07:18:32,537 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such column: stock_prices.interval

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 434, in save_to_database
    ).first()
      ~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\WINDOWS 11 PRO\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: stock_prices.interval
[SQL: SELECT stock_prices.id AS stock_prices_id, stock_prices.stock_id AS stock_prices_stock_id, stock_prices.date AS stock_prices_date, stock_prices.interval AS stock_prices_interval, stock_prices.open AS stock_prices_open, stock_prices.high AS stock_prices_high, stock_prices.low AS stock_prices_low, stock_prices.close AS stock_prices_close, stock_prices.volume AS stock_prices_volume 
FROM stock_prices 
WHERE stock_prices.stock_id = ? AND stock_prices.date = ?
 LIMIT ? OFFSET ?]
[parameters: (19, '2025-04-11 00:00:00.000000', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-06-01 07:18:32,537 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:18:33,539 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:21:28,889 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:21:28,890 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:21:28,890 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:21:28,902 - __main__ - INFO - Menggunakan DATABASE_URL dari environment: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:21:28,902 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:21:28,941 - __main__ - INFO - Mengupgrade skema SQLite: menambahkan kolom interval ke tabel stock_prices
2025-06-01 07:21:28,995 - __main__ - INFO - Mengupgrade skema SQLite: menambahkan kolom interval ke tabel stock_indicators
2025-06-01 07:21:29,004 - __main__ - INFO - Database SQLite berhasil diupgrade, memeriksa ulang skema
2025-06-01 07:21:29,006 - __main__ - INFO - Skema database: tabel stock_prices memiliki kolom interval
2025-06-01 07:21:29,006 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:21:29,006 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:21:29,038 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:21:29,038 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:21:30,442 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:21:30,463 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:21:30,473 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:21:30,474 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:21:34,589 - __main__ - INFO - Status skema DB: has_interval_column=True
2025-06-01 07:21:34,595 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: type object 'StockIndicator' has no attribute 'interval'
2025-06-01 07:21:34,598 - __main__ - ERROR - Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 520, in save_to_database
    StockIndicator.interval == interval
    ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'StockIndicator' has no attribute 'interval'

2025-06-01 07:21:34,599 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:21:35,600 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:24:33,324 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:24:33,325 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:24:33,325 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:24:33,337 - __main__ - INFO - Menggunakan DATABASE_URL dari environment: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:24:33,337 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:24:33,380 - __main__ - INFO - Skema database: tabel stock_prices memiliki kolom interval
2025-06-01 07:24:33,380 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:24:33,381 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:24:33,419 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:24:33,419 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:24:33,958 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:24:33,972 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:24:33,980 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:24:33,981 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:24:38,108 - __main__ - INFO - Status skema DB: has_interval_column=True
2025-06-01 07:24:38,124 - __main__ - ERROR - Error saat menyimpan data BBCA.JK: cannot access local variable 'rows_saved' where it is not associated with a value
2025-06-01 07:24:38,127 - __main__ - ERROR - Traceback (most recent call last):
  File "D:\Zahaam\stock-prediction\backend\fetch_historical_data_pg.py", line 563, in save_to_database
    rows_saved += 1
    ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'rows_saved' where it is not associated with a value

2025-06-01 07:24:38,127 - __main__ - INFO - Berhasil menyimpan 0 baris data BBCA.JK interval 1d
2025-06-01 07:24:39,129 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
2025-06-01 07:31:39,790 - __main__ - WARNING - PostgreSQL tidak tersedia: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2025-06-01 07:31:39,791 - __main__ - INFO - Menggunakan SQLite sebagai fallback: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:31:39,791 - __main__ - INFO - ===== MEMULAI PROSES PENGAMBILAN DATA HISTORIS SAHAM =====
2025-06-01 07:31:39,803 - __main__ - INFO - Menggunakan DATABASE_URL dari environment: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:31:39,804 - __main__ - INFO - Menggunakan SQLite: sqlite:///D:\Zahaam\stock-prediction\backend\stock_prediction.db
2025-06-01 07:31:39,844 - __main__ - INFO - Skema database: tabel stock_prices memiliki kolom interval
2025-06-01 07:31:39,844 - __main__ - INFO - Mengambil data untuk ticker spesifik: BBCA.JK
2025-06-01 07:31:39,844 - __main__ - INFO - Menggunakan interval 1d dengan periode 30d
2025-06-01 07:31:39,882 - __main__ - INFO - === Memproses BBCA.JK ===
2025-06-01 07:31:39,882 - __main__ - INFO - Mengambil BBCA.JK dengan period=30d, interval=1d
2025-06-01 07:31:40,522 - __main__ - WARNING - Data terlalu sedikit untuk perhitungan indikator lengkap: 30 baris
2025-06-01 07:31:40,540 - __main__ - WARNING - Gagal menghitung MACD: unsupported operand type(s) for -: 'float' and 'NoneType'
2025-06-01 07:31:40,551 - __main__ - INFO - Berhasil menghitung indikator untuk 30 baris data
2025-06-01 07:31:40,551 - __main__ - INFO - Berhasil mengambil 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:31:44,683 - __main__ - INFO - Status skema DB: has_interval_column=True
2025-06-01 07:31:44,942 - __main__ - INFO - Berhasil menyimpan 30 baris data BBCA.JK dengan interval 1d
2025-06-01 07:31:44,942 - __main__ - INFO - Berhasil menyimpan 30 baris data BBCA.JK interval 1d
2025-06-01 07:31:45,944 - __main__ - INFO - ===== PROSES PENGAMBILAN DATA HISTORIS SAHAM SELESAI =====
